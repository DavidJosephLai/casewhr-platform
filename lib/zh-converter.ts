// 繁體轉簡體字典 (詞組優先策略 - 避免重複鍵)
const t2sMap: Record<string, string> = {
  // === 詞組轉換（優先匹配） ===
  '專業': '专业', '營銷': '营销', '諮詢': '咨询', '發布': '发布', '項目': '项目',
  '設計': '设计', '開發': '开发', '數據': '数据', '關於': '关于', '聯繫': '联系',
  '電子': '电子', '郵件': '邮件', '賬戶': '账户', '帳戶': '账户', '帳號': '账号',
  '賬號': '账号', '註冊': '注册', '登錄': '登录', '確認': '确认', '資料': '资料',
  '個人': '个人', '頁面': '页面', '瀏覽': '浏览', '選擇': '选择', '類別': '类别',
  '標題': '标题', '預算': '预算', '時間': '时间', '技能': '技能', '搜尋': '搜索',
  '篩選': '筛选', '顯示': '显示', '評價': '评价', '評分': '评分', '審查': '审查',
  '審核': '审核', '進行': '进行', '狀態': '状态', '協作': '协作', '團隊': '团队',
  '組織': '组织', '優先': '优先', '進階': '进阶', '當前': '当前', '訂閱': '订阅',
  '會員': '会员', '機構': '机构', '專家': '专家', '驗證': '验证', '質量': '质量',
  '標準': '标准', '連接': '连接', '頂級': '顶级', '經過': '经过', '檔案': '档案',
  '簡歷': '简历', '應用': '应用', '網站': '网站', '訪問': '访问', '訊息': '讯息',
  '職業': '职业', '報價': '报价', '適合': '适合', '聘請': '聘请', '業務': '业务',
  '財務': '财务', '資源': '资源', '區域': '区域', '視頻': '视频', '動畫': '动画',
  '製作': '制作', '記錄': '记录', '網絡': '网络', '職業者': '职业者', '議價': '议价',
  '過期': '过期', '條款': '条款', '隱私': '隐私', '總計': '总计', '幫助': '帮助',
  '協議': '协议', '規劃': '规划', '將來': '将来', '還原': '还原', '復原': '复原',
  '複製': '复制', '設定': '设定', '設置': '设置', '認證': '认证', '處理': '处理',
  '傭金': '佣金', '繼續': '继续', '經驗': '经验', '識別': '识别', '財產': '财产',
  '擔保': '担保', '報告': '报告', '詢問': '询问', '問題': '问题', '進入': '进入',
  '離開': '离开', '歷史': '历史', '變更': '变更', '變化': '变化', '換匯': '换汇',
  '匯率': '汇率', '幣種': '币种', '幣值': '币值', '撥款': '拨款', '臺灣': '台湾',
  '臺中': '台中', '繁體': '繁体', '簡體': '简体', '語言': '语言', '碼頭': '码头',
  '條件': '条件', '週一': '周一', '週二': '周二', '週三': '周三', '週四': '周四',
  '週五': '周五', '週六': '周六', '週日': '周日', '號碼': '号码', '標籤': '标签',
  '標記': '标记', '簽名': '签名', '導覽': '导览', '導向': '导向', '導航': '导航',
  '嚮導': '向导', '達成': '达成', '達到': '达到', '達標': '达标', '滿意': '满意',
  '馬上': '马上', '檢查': '检查', '檢視': '检视', '檢測': '检测', '測試': '测试',
  '試用': '试用', '嘗試': '尝试', '錯誤': '错误', '並且': '并且', '關閉': '关闭',
  '關鍵': '关键', '鑰匙': '钥匙', '確定': '确定', '確實': '确实', '確保': '确保',
  '實施': '实施', '實現': '实现', '實時': '实时', '實際': '实际', '執行': '执行',
  '過程': '过程', '過濾': '过滤', '滿足': '满足', '適應': '适应', '應對': '应对',
  '對應': '对应', '應該': '应该', '該當': '该当', '當天': '当天', '當時': '当时',
  '時候': '时候', '時刻': '时刻', '時段': '时段', '階段': '阶段', '層次': '层次',
  '層級': '层级', '級別': '级别', '區別': '区别', '區分': '区分', '劃分': '划分',
  '規則': '规则', '規定': '规定', '規範': '规范', '範圍': '范围', '範例': '范例',
  '範本': '范本', '樣本': '样本', '樣式': '样式', '格式': '格式', '樣品': '样品',
  '樣貌': '样貌', '貌似': '貌似', '樣子': '样子', '態度': '态度', '狀況': '状况',
  '況且': '况且', '而況': '而况', '況味': '况味', '實況': '实况', '況狀': '况状',
  '面貌': '面貌', '樣樣': '样样', '樣樣精': '样样精', '樣樣通': '样样通',
  '身體': '身体', '迴圈': '回圈', '迴響': '回响', '連續': '连续', '連線': '连线',
  '連鎖': '连锁', '連結': '连结', '連結器': '连结器', '進度': '进度', '進程': '进程',
  '進化': '进化', '進展': '进展', '進軍': '进军', '適當': '适当', '選單': '选单',
  '選取': '选取', '選手': '选手', '選項': '选项', '還款': '还款', '錄音': '录音',
  '錄影': '录影', '錄取': '录取', '錢包': '钱包', '鍵盤': '键盘', '鎖定': '锁定',
  '鏈接': '链接', '鐘錶': '钟表', '開關': '开关', '關稅': '关税', '閱讀': '阅读',
  '限額': '限额', '階級': '阶级', '險境': '险境', '雜誌': '杂志', '雜費': '杂费',
  '電腦': '电脑', '電話': '电话', '電郵': '电邮', '餘額': '余额', '餘款': '余款',
  '首頁': '首页', '點擊': '点击', '點選': '点选',

  // === 單字轉換（僅列出不會重複的） ===
  '專': '专', '業': '业', '與': '与', '為': '为', '從': '从', '讓': '让',
  '總': '总', '職': '职', '時': '时', '週': '周', '過': '过', '將': '将',
  '於': '于', '對': '对', '們': '们', '這': '这', '說': '说', '請': '请',
  '現': '现', '點': '点', '區': '区', '聘': '聘', '變': '变', '圖': '图',
  '運': '运', '記': '记', '錢': '钱', '幣': '币', '務': '务', '環': '环',
  '實': '实', '際': '际', '險': '险', '礙': '碍', '緊': '紧', '張': '张',
  '準': '准', '備': '备', '線': '线', '緒': '绪', '續': '续', '積': '积',
  '極': '极', '義': '义', '擇': '择', '撥': '拨', '預': '预', '單': '单',
  '復': '复', '檢': '检', '機': '机', '會': '会', '構': '构', '審': '审',
  '覽': '览', '證': '证', '號': '号', '識': '识', '錄': '录', '銷': '销',
  '購': '购', '達': '达', '規': '规', '種': '种', '獲': '获', '離': '离',
  '還': '还', '貼': '贴', '畫': '画', '調': '调', '應': '应', '該': '该',
  '許': '许', '託': '托', '處': '处', '雇': '雇', '傭': '佣', '繼': '继',
  '導': '导', '權': '权', '經': '经', '認': '认', '產': '产', '後': '后',
  '價': '价', '貴': '贵', '統': '统', '據': '据', '擔': '担', '詢': '询',
  '諮': '咨', '問': '问', '答': '答', '覆': '复', '題': '题', '課': '课',
  '歷': '历', '錶': '表', '鐘': '钟', '鈕': '钮', '層': '层', '級': '级',
  '樣': '样', '態': '态', '換': '换', '轉': '转', '匯': '汇', '臺': '台',
  '灣': '湾', '簡': '简', '體': '体', '語': '语', '碼': '码', '編': '编',
  '條': '条', '標': '标', '簽': '签', '籤': '签', '嚮': '向', '滿': '满',
  '馬': '马', '測': '测', '試': '试', '嘗': '尝', '錯': '错', '誤': '误',
  '並': '并', '閉': '闭', '鍵': '键', '鑰': '钥', '確': '确', '施': '施',
  '執': '执', '濾': '滤', '適': '适', '當': '当', '段': '段', '階': '阶',
  '別': '别', '劃': '划', '則': '则', '範': '范', '圍': '围', '式': '式',
  '貌': '貌', '況': '况', '約': '约', '紀': '纪', '練': '练', '組': '组',
  '細': '细', '結': '结', '給': '给', '絡': '络', '羅': '罗', '習': '习',
  '聯': '联', '聲': '声', '聽': '听', '肅': '肃', '舊': '旧', '節': '节',
  '萬': '万', '葉': '叶', '著': '着', '藝': '艺', '虧': '亏', '虛': '虚',
  '蠶': '蚕', '術': '术', '衛': '卫', '裝': '装', '覺': '觉', '觀': '观',
  '訂': '订', '計': '计', '訊': '讯', '討': '讨', '訓': '训', '訪': '访',
  '設': '设', '訴': '诉', '診': '诊', '註': '注', '証': '证', '詞': '词',
  '評': '评', '詳': '详', '詩': '诗', '話': '话', '誠': '诚', '諸': '诸',
  '論': '论', '謀': '谋', '講': '讲', '謝': '谢', '護': '护', '譽': '誉',
  '讀': '读', '讚': '赞', '豈': '岂', '貝': '贝', '負': '负', '貢': '贡',
  '貨': '货', '質': '质', '賀': '贺', '賓': '宾', '賜': '赐', '賞': '赏',
  '賠': '赔', '賽': '赛', '贈': '赠', '贊': '赞', '趕': '赶', '趨': '趋',
  '跡': '迹', '踐': '践', '蹟': '迹', '躍': '跃', '軌': '轨', '軍': '军',
  '軟': '软', '較': '较', '載': '载', '輕': '轻', '輛': '辆', '輝': '辉',
  '輔': '辅', '輸': '输', '轍': '辙', '辦': '办', '農': '农', '迴': '回',
  '遠': '远', '鄉': '乡', '鎖': '锁', '鏈': '链', '長': '长', '門': '门',
  '開': '开', '閑': '闲', '間': '间', '閣': '阁', '閱': '阅', '陰': '阴',
  '陽': '阳', '陸': '陆', '陳': '陈', '隊': '队', '隨': '随', '隱': '隐',
  '雙': '双', '雜': '杂', '難': '难', '電': '电', '霧': '雾', '靈': '灵',
  '靜': '静', '韓': '韩', '頁': '页', '頂': '顶', '項': '项', '順': '顺',
  '須': '须', '頌': '颂', '頗': '颇', '領': '领', '頭': '头', '頻': '频',
  '額': '额', '顧': '顾', '顯': '显', '風': '风', '颱': '台', '飛': '飞',
  '飯': '饭', '飲': '饮', '館': '馆', '餘': '余', '餓': '饿', '駐': '驻',
  '驅': '驱', '駕': '驾', '驗': '验', '驚': '惊', '骯': '肮', '髮': '发',
  '鬥': '斗', '鬧': '闹', '鬱': '郁', '魚': '鱼', '鳥': '鸟', '鹵': '卤',
  '鹽': '盐', '麗': '丽', '麥': '麦', '麩': '麸', '麵': '面', '黃': '黄',
  '齊': '齐', '齒': '齿', '齡': '龄', '龍': '龙', '龐': '庞', '龜': '龟'
};

// 預編譯正則表達式以提升效能並避免重複轉換
const compiledPatterns = (() => {
  const patterns: Array<[RegExp, string]> = [];
  // 按長度降序排序,確保先匹配較長的詞組
  const sortedKeys = Object.keys(t2sMap).sort((a, b) => b.length - a.length);
  
  for (const traditional of sortedKeys) {
    const simplified = t2sMap[traditional];
    // 轉義正則表達式特殊字元
    const escaped = traditional.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
    patterns.push([new RegExp(escaped, 'g'), simplified]);
  }
  
  return patterns;
})();

// 將繁體文字轉換為簡體
export function convertToSimplified(text: string): string {
  if (!text) return text;
  
  let result = text;
  
  // 使用預編譯的正則表達式進行替換,避免重複轉換
  for (const [pattern, replacement] of compiledPatterns) {
    result = result.replace(pattern, replacement);
  }
  
  return result;
}

// 深度轉換對象中的所有字符串
export function deepConvertObject<T>(obj: T): T {
  if (typeof obj === 'string') {
    return convertToSimplified(obj) as unknown as T;
  }
  
  if (Array.isArray(obj)) {
    return obj.map(item => deepConvertObject(item)) as unknown as T;
  }
  
  if (obj !== null && typeof obj === 'object') {
    const result: any = {};
    for (const key in obj) {
      if (Object.prototype.hasOwnProperty.call(obj, key)) {
        result[key] = deepConvertObject((obj as any)[key]);
      }
    }
    return result;
  }
  
  return obj;
}